{"version":3,"sources":["../src/carousel.js"],"names":["define","$","ModalFactory","Ajax","init","blockid","numslides","autoplay","playspeed","show","breakpoints","breakpoint","settings","slidesToShow","carousel","slick","dots","infinite","speed","adaptiveHeight","autoplaySpeed","responsive","observer","ResizeObserver","window","trigger","observe","get","modal","rowid","modalTitle","slide","document","querySelector","addEventListener","create","type","types","CANCEL","title","body","dataset","modalcontent","then","proxy","getRoot","addClass","setLarge","videocontrol","slideid","video","slideparent","parents","attr","play","pause","on","interaction","call","methodname","args","fail"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Load the carousel.\n *\n * @module    block_carousel/carousel\n * @copyright 2021 TRL Education Limited\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery', 'core/modal_factory', 'core/ajax', 'block_carousel/slick'], function($, ModalFactory, Ajax) {\n    return {\n        init: function(blockid, numslides, autoplay, playspeed) {\n            $('#carousel' + blockid + ' .slidewrap').show();\n\n            // Setup breakpoint array.\n            // Breakpoints set to 1 above the standard width, as expressions like >= 1024 don't work.\n            if (numslides > 1) {\n                var breakpoints = [{\n                    breakpoint: 1025,\n                    settings: {\n                        slidesToShow: 2,\n                    }\n                }, {\n                    breakpoint: 769,\n                    settings: {\n                        slidesToShow: 1,\n                    }\n                }];\n            } else {\n                var breakpoints = [];\n            }\n\n            var carousel = $('#carousel' + blockid);\n            carousel.slick({\n                dots: true,\n                infinite: true,\n                speed: 300,\n                slidesToShow: numslides,\n                adaptiveHeight: true,\n                autoplay: autoplay,\n                autoplaySpeed: playspeed,\n                responsive: breakpoints\n            });\n\n            // This is a special case for when carousel is embedded in another block.\n            // When the carousel is resized, we need to resize.\n            // This causes slick to natively resize itself.\n            var observer = new ResizeObserver(function() {\n                $(window).trigger('resize');\n            });\n\n            observer.observe(carousel.get('0'));\n        },\n\n        modal: function(rowid, modalTitle) {\n            var slide = document.querySelector('#id_slide' + rowid);\n            slide.addEventListener('click', function(){\n                ModalFactory.create(\n                    {\n                        type: ModalFactory.types.CANCEL,\n                        title: modalTitle,\n                        body: slide.dataset.modalcontent\n                    }\n                ).then($.proxy(function(modal) {\n                    modal.getRoot().addClass('block_carousel');\n\n                    modal.setLarge();\n                    modal.show();\n                }));\n            });\n        },\n\n        videocontrol: function(blockid, slideid) {\n            var videocontrol = function() {\n                var video = document.querySelector('#id_slidevideo' + slideid);\n                var slideparent = $('#id_slidecontainer' + slideid).parents('.slick-slide');\n                if (slideparent.attr('aria-hidden') === 'false') {\n                    // This is the active slide. Unpause the video with this slideID.\n                    video.play();\n                } else {\n                    // Non active slide. Pause it.\n                    video.pause();\n                }\n            };\n            var carousel = $('#carousel' + blockid);\n            carousel.on('afterChange', videocontrol);\n            carousel.on('init', videocontrol);\n        },\n\n        interaction: function(slideid) {\n            var slide = document.querySelector('#id_slide' + slideid);\n            slide.addEventListener('click', function(){\n                var request = {\n                    methodname: 'block_carousel_record_interaction',\n                    args: {\n                        rowid: slideid\n                    }\n                };\n                Ajax.call([request])[0].fail();\n            });\n        }\n    };\n});\n"],"file":"carousel.min.js"}